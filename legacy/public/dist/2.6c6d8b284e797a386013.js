webpackJsonp([2],{

/***/ 808:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = connectP2P;\n\nvar _socket = __webpack_require__(347);\n\nvar _socket2 = _interopRequireDefault(_socket);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * @param {Object} socket io instance\n * @returns {Object} socket.io-p2p instance\n */\nfunction connectP2P(socket) {\n  var p2p = new _socket2.default(socket, { autoUpgrade: false });\n  return p2p;\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODA4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NsaWVudC9zb2NrZXQvcDJwL2luZGV4LmpzPzg2MGEiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gY29ubmVjdFAyUDtcblxudmFyIF9zb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQuaW8tcDJwJyk7XG5cbnZhciBfc29ja2V0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NvY2tldCk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8qKlxuICogQHBhcmFtIHtPYmplY3R9IHNvY2tldCBpbyBpbnN0YW5jZVxuICogQHJldHVybnMge09iamVjdH0gc29ja2V0LmlvLXAycCBpbnN0YW5jZVxuICovXG5mdW5jdGlvbiBjb25uZWN0UDJQKHNvY2tldCkge1xuICB2YXIgcDJwID0gbmV3IF9zb2NrZXQyLmRlZmF1bHQoc29ja2V0LCB7IGF1dG9VcGdyYWRlOiBmYWxzZSB9KTtcbiAgcmV0dXJuIHAycDtcbn1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9jbGllbnQvc29ja2V0L3AycC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gODA4XG4vLyBtb2R1bGUgY2h1bmtzID0gMiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///808\n");

/***/ }),

/***/ 915:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _socket = __webpack_require__(334);\n\nvar _socket2 = _interopRequireDefault(_socket);\n\nvar _p2p = __webpack_require__(808);\n\nvar _p2p2 = _interopRequireDefault(_p2p);\n\nvar _socket3 = __webpack_require__(809);\n\nvar _store = __webpack_require__(403);\n\nvar _store2 = _interopRequireDefault(_store);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar socketEventHandlers = {\n  connect: function connect() {\n    console.log('Connection established with server');\n  },\n  disconnect: function disconnect() {\n    console.log('Connect to the server terminated');\n    _store2.default.dispatch((0, _socket3.handleSocketDisconnect)());\n  },\n  message: function message(data) {\n    console.log(data);\n  }\n};\n\nvar attachEventListeners = function attachEventListeners(socket) {\n  return Object.keys(socketEventHandlers).map(function (event) {\n    return socket.on(event, socketEventHandlers[event].bind(null, _store2.default));\n  });\n};\n\nvar connect = function connect(token) {\n  return _socket2.default.connect(\"http://72.225.197.202:4000/\", { query: 'token=' + token });\n};\n\nvar _store$getState = _store2.default.getState(),\n    token = _store$getState.token;\n\nvar socket = connect(token);\nattachEventListeners(socket, _store2.default);\n\nsocket.p2p = (0, _p2p2.default)(socket);\n\n_store2.default.subscribe(function () {\n  var _store$getState2 = _store2.default.getState(),\n      newToken = _store$getState2.token;\n\n  if (newToken === token) return;\n  if (socket) socket.disconnect();\n  socket = null;\n  if (newToken) socket = connect(newToken);\n  if (socket) attachEventListeners(socket, _store2.default);\n  token = newToken;\n});\n\nexports.default = function () {\n  return socket;\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTE1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NsaWVudC9zb2NrZXQvY2xpZW50LmpzPzBkMjQiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3NvY2tldCA9IHJlcXVpcmUoJ3NvY2tldC5pby1jbGllbnQnKTtcblxudmFyIF9zb2NrZXQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc29ja2V0KTtcblxudmFyIF9wMnAgPSByZXF1aXJlKCcuL3AycCcpO1xuXG52YXIgX3AycDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wMnApO1xuXG52YXIgX3NvY2tldDMgPSByZXF1aXJlKCcuLi9hY3Rpb25zL3NvY2tldCcpO1xuXG52YXIgX3N0b3JlID0gcmVxdWlyZSgnLi4vc3RvcmUnKTtcblxudmFyIF9zdG9yZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdG9yZSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciBzb2NrZXRFdmVudEhhbmRsZXJzID0ge1xuICBjb25uZWN0OiBmdW5jdGlvbiBjb25uZWN0KCkge1xuICAgIGNvbnNvbGUubG9nKCdDb25uZWN0aW9uIGVzdGFibGlzaGVkIHdpdGggc2VydmVyJyk7XG4gIH0sXG4gIGRpc2Nvbm5lY3Q6IGZ1bmN0aW9uIGRpc2Nvbm5lY3QoKSB7XG4gICAgY29uc29sZS5sb2coJ0Nvbm5lY3QgdG8gdGhlIHNlcnZlciB0ZXJtaW5hdGVkJyk7XG4gICAgX3N0b3JlMi5kZWZhdWx0LmRpc3BhdGNoKCgwLCBfc29ja2V0My5oYW5kbGVTb2NrZXREaXNjb25uZWN0KSgpKTtcbiAgfSxcbiAgbWVzc2FnZTogZnVuY3Rpb24gbWVzc2FnZShkYXRhKSB7XG4gICAgY29uc29sZS5sb2coZGF0YSk7XG4gIH1cbn07XG5cbnZhciBhdHRhY2hFdmVudExpc3RlbmVycyA9IGZ1bmN0aW9uIGF0dGFjaEV2ZW50TGlzdGVuZXJzKHNvY2tldCkge1xuICByZXR1cm4gT2JqZWN0LmtleXMoc29ja2V0RXZlbnRIYW5kbGVycykubWFwKGZ1bmN0aW9uIChldmVudCkge1xuICAgIHJldHVybiBzb2NrZXQub24oZXZlbnQsIHNvY2tldEV2ZW50SGFuZGxlcnNbZXZlbnRdLmJpbmQobnVsbCwgX3N0b3JlMi5kZWZhdWx0KSk7XG4gIH0pO1xufTtcblxudmFyIGNvbm5lY3QgPSBmdW5jdGlvbiBjb25uZWN0KHRva2VuKSB7XG4gIHJldHVybiBfc29ja2V0Mi5kZWZhdWx0LmNvbm5lY3QocHJvY2Vzcy5lbnYuQVBQX1VSTCwgeyBxdWVyeTogJ3Rva2VuPScgKyB0b2tlbiB9KTtcbn07XG5cbnZhciBfc3RvcmUkZ2V0U3RhdGUgPSBfc3RvcmUyLmRlZmF1bHQuZ2V0U3RhdGUoKSxcbiAgICB0b2tlbiA9IF9zdG9yZSRnZXRTdGF0ZS50b2tlbjtcblxudmFyIHNvY2tldCA9IGNvbm5lY3QodG9rZW4pO1xuYXR0YWNoRXZlbnRMaXN0ZW5lcnMoc29ja2V0LCBfc3RvcmUyLmRlZmF1bHQpO1xuXG5zb2NrZXQucDJwID0gKDAsIF9wMnAyLmRlZmF1bHQpKHNvY2tldCk7XG5cbl9zdG9yZTIuZGVmYXVsdC5zdWJzY3JpYmUoZnVuY3Rpb24gKCkge1xuICB2YXIgX3N0b3JlJGdldFN0YXRlMiA9IF9zdG9yZTIuZGVmYXVsdC5nZXRTdGF0ZSgpLFxuICAgICAgbmV3VG9rZW4gPSBfc3RvcmUkZ2V0U3RhdGUyLnRva2VuO1xuXG4gIGlmIChuZXdUb2tlbiA9PT0gdG9rZW4pIHJldHVybjtcbiAgaWYgKHNvY2tldCkgc29ja2V0LmRpc2Nvbm5lY3QoKTtcbiAgc29ja2V0ID0gbnVsbDtcbiAgaWYgKG5ld1Rva2VuKSBzb2NrZXQgPSBjb25uZWN0KG5ld1Rva2VuKTtcbiAgaWYgKHNvY2tldCkgYXR0YWNoRXZlbnRMaXN0ZW5lcnMoc29ja2V0LCBfc3RvcmUyLmRlZmF1bHQpO1xuICB0b2tlbiA9IG5ld1Rva2VuO1xufSk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHNvY2tldDtcbn07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvY2xpZW50L3NvY2tldC9jbGllbnQuanNcbi8vIG1vZHVsZSBpZCA9IDkxNVxuLy8gbW9kdWxlIGNodW5rcyA9IDIiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///915\n");

/***/ })

});